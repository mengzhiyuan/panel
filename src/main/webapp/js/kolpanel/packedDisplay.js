/*! 版权所有，翻版必究 */
!function(n){function e(i){if(s[i])return s[i].exports;var t=s[i]={i:i,l:!1,exports:{}};return n[i].call(t.exports,t,t.exports,e),t.l=!0,t.exports}var s={};e.m=n,e.c=s,e.d=function(n,s,i){e.o(n,s)||Object.defineProperty(n,s,{configurable:!1,enumerable:!0,get:i})},e.n=function(n){var s=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(s,"a",s),s},e.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},e.p="",e(e.s=0)}([function(n,e,s){"use strict";var i=window.document.location.href,t=window.document.location.pathname,a=i.indexOf(t),o=i.substring(0,a),d=t.substring(0,t.substr(1).indexOf("/")+1),l=o+d;$(function(){var n,e={},s=location.href,i=s.indexOf("?");s=s.substr(i+1);for(var t=s.split("&"),a=0;a<t.length;a++)(i=t[a].indexOf("="))>0&&(n=t[a].substring(0,i),"wj"==n&&(e.kol=t[a].substr(i+1)),"urlcode"==n&&(e.urlcode=t[a].substr(i+1)));var o={surveyId:"",availability:0,completion:0,list:[],qs:[],vues:[],answers:[],now:0,time_question:"",time_survey:"",question_number:"",passwordNeeded:"",verificationCodeNeeded:"",disposableForClient:"",disposableForIp:"",disposableForDevice:"",startQuestionnaire:function(){$("#cover").hide(),this.countDown(),this.putQuestions()},displaySurvey:function(n){var e=JSON.parse(n.setting)[0],s=n.wjId,i=n.sitId||"",t=n.count,a=n.title,o=n.describe;this.qs=[],this.vues=[],this.answers=[],this.now=0;for(var d=0,l=n.wjQuestion.length;d<l;d++)this.qs.push(JSON.parse(n.wjQuestion[d].itemContent)[0]),this.qs[this.qs.length-1].idInSQL=n.wjQuestion[d].itemId;this.qs.sort(this.compare("index")),this.answers=new Array(this.qs.length+1),e.time_question&&e.time_question.restrict?this.time_question=e.time_question.time:this.buttonInterval=function(){},e.time_survey&&e.time_survey.restrict?this.time_survey=e.time_survey.time:this.countDown=function(){},$("#title").find("span").text(a),$("#subtitle").find("span").text(o),sessionStorage.setItem("sitId",i),this.surveyId=s,this.question_number=t,this.passwordNeeded=e.passwordNeeded,this.verificationCodeNeeded=e.verificationCodeNeeded,this.clientOnly=e.clientOnly,this.disposableForClient=e.disposableForClient,this.disposableForIp=e.disposableForIp,this.disposableForDevice=e.disppsableForDevice},compare:function(n){return function(e,s){var i=e[n],t=s[n];return t<i?1:t>i?-1:0}},countDown:function(){function n(){if(s<=0)return void $("#save").prop("disabled",!1);s%60==0?(i-=1,t=59,a.text(i),o.text(t)):(t-=1,o.text(t)),s-=1}$("#save").prop("disabled",!0);var e=this.time_survey,s=60*e,i=e,t="00",a=$("#time_long").find(".minutes"),o=$("#time_long").find(".seconds");a.text(i),o.text(t);setInterval(n.bind(this),1e3)},previousQ:function(n){for(var e=this.qs,s=this.now,i=(e[s],this.answers[s+1],[]),t=1,a=s+1;t<=a;t++){var o=this.answers[t],d=e[t-1];(o&&o.values&&o.values.length||!d.required)&&i.push(t-1)}$("#q"+(s+1)).remove(),this.now=i[i.length-1],this.putQuestions()},nextQ:function(n){var e=this.qs,s=this.now,i=e[s],t=this.answers[s+1];if(!t||!t.values||0===t.values.length)return!1;$("#q"+(s+1)).remove();var a=!1,o=i.jump;for(var d in o)if(d){a=!0;break}if(a)for(var r in o)if(o[r].target&&t.values.indexOf(o[r].value)>-1)return"over"===o[r].target?(this.availability=3,this.submitAnswers(n),document.location.href=l+"/html/kolpanel/endSurvey.html",!1):(this.now=parseInt(o[r].target)-1,this.putQuestions(),!1);return this.submitAnswers(n),this.now++,this.putQuestions(),!1},putQuestions:function(){function n(){t.setRelate(i),t.setQuote(i),t.setEvaluate(i);var n=$(document.createElement("qs")),s=$("#buttons");$("#skip").prop("disabled",i.required);var a=$("#save");e.indexOf(i)===e.length-1?(a.css("display","inline-block"),$("#next").css("display","none"),$("#skip").css("display","none")):a.css("display","none"),n.attr("id","q"+i.itemId),t.setAttr(n),n.insertBefore(s),s.css("display","block"),"sort"===i.type&&(i.sorted=[]),t.vues.push(new Vue({el:"#q"+i.itemId,data:i,methods:t.funcs})),t.buttonInterval()}var e=this.qs,s=this.now,i=e[s],t=this;if(i.depend.itemId){var a=this.answers[i.depend.itemId],o=!1;if(a){for(var d in i.depend.options)a.values.indexOf(i.depend.options[d])>-1&&(o=!0);o?n():(this.now++,this.putQuestions())}}else n()},setRelate:function(n){if(n.relate.itemId){var e=this.answers[n.relate.itemId].values;for(var s in n.options){var i=n.options[s];i.render=e.indexOf(i.value)>-1}}},setQuote:function(n){if(n.quote.itemId){var e=this.answers[n.quote.itemId].values[0];n.title.replace(/\[引用\]/g,e)}},setEvaluate:function(n){if(n.evaluate.itemId){var e=this.answers[n.quote.itemId].values[0];for(var s in n.evaluate.matches)n.evaluate.matches[s].value===e&&n.title.replace(/\[赋值\]/g,e)}},setAttr:function(n){n.attr(":index","index"),n.attr(":item_id","itemId"),n.attr(":title","title"),n.attr(":type","type"),n.attr(":form","form"),n.attr(":need","need"),n.attr(":the_class","theClass"),n.attr(":required","required"),n.attr(":description","description"),n.attr(":options","options"),n.attr(":sub_questions","sub_questions"),n.attr("v-on:check","check"),n.attr("v-on:fill_check","fillCheck"),n.attr("v-on:fill_blank","fillBlank"),n.attr("v-on:check_matrix","checkMatrix"),n.attr("v-on:input_matrix","inputMatrix"),n.attr("v-on:mark","mark"),n.attr("v-on:sort","sort")},buttonInterval:function(){function n(){for(e-=1,s.text(e);e<=0;)return $("#next").prop("disabled",!1),clearInterval(t),void s.text(i)}var e=parseInt(this.time_question),s=$("#next");"none"!=$("#save").css("display")&&(s=$("#save"));var i=s.text();s.prop("disabled",!0).text(e);var t=setInterval(n.bind(this),1e3)},submitAnswers:function(e){var s=new RegExp("(^|&)"+n+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(s),t={surveyId:this.surveyId,availability:this.availability,completion:parseInt(100*(this.answers.length-1)/this.question_number)+"%",sitId:sessionStorage.getItem("sitId")||"",sitName:"",answers:this.answers[this.now+1],completed:!1};if(unescape(i[2])?t.sitName=unescape(i[2]):sessionStorage.getItem("surveyName")?t.sitName=sessionStorage.getItem("surveyName"):t.sitName="","save"===$(e.target).attr("id")){var a=!0;t.completed=!0,t.availability=1}$.ajax({url:l+"/questionnaire/collect",type:"post",contentType:"application/json;charset=utf-8",dataType:"json",async:!0,data:JSON.stringify(t),success:function(n){var e=n[0].sitId;sessionStorage.getItem("sitId")||sessionStorage.setItem("sitId",e),a&&("success"===n[0].result?document.location.href=l+"/html/kolpanel/completeSurvey.html":"error"===n[0].result&&console.log(n))},error:function(n){console.log(n)}})},tpl:'\n        <div class="inners" :id="\'q\' + index">\n            <div class="inner choice" v-if="type===\'choice\'">\n                <div class="question_head">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title">{{ title }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="description">{{ description }}</div>\n                <div class="answers">\n                    <div class="input choice" v-for="option in options" :key="option.optionId">\n                        <input :option_code="option.index" :id="\'radio_q\' + index + \'_op\' + option.optionId" :name="\'q\' + index" type="radio" :value="option.value" @change="check">\n                        <label :for="\'radio_q\' + index + \'_op\' + option.optionId">\n                            <i class="icon"><span></span></i>\n                            <span class="option_text">{{ option.value }}</span>\n                        </label>\n                        <span class="blank" contenteditable="true" v-show="option.fillable" @input="option.value=event.target.innerText"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="inner checks" v-if="type===\'checks\'">\n                <div class="question_head">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title">{{ title }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="description">{{ description }}</div>\n                <div class="answers">\n                    <div class="input checks" v-for="option in options" :key="option.optionId">\n                        <input :option_code="option.index" :id="\'checks_q\' + index + \'_op\' + option.optionId" :name="\'q\' + index" type="checkbox" :value="option.value" @change="check">\n                        <label :for="\'checks_q\' + index + \'_op\' + option.optionId">\n                            <i class="icon"><span></span></i>\n                            <span class="option_text">{{ option.value }}</span>\n                        </label>\n                        <span class="blank" contenteditable="true" v-show="option.fillable" @input="option.value=event.target.innerText"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="inner blank" v-if="type===\'blank\'">\n                <div class="question_head">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title">{{ title }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="description">{{ description }}</div>\n                <div class="answers single" v-show="form===\'single\'">\n                    <div class="input blank">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n                <div class="answers multi" v-show="form===\'multi\'">\n                    <div class="input blank">\n                        <div class="questions" v-for="question in sub_questions" :key="question.index">\n                            <span class="sub_question">{{ question.title }}<i>:</i></span>\n                            <span :question_code="question.index" class="blank" contenteditable="true" :title="question.title" :index="question.index" @input="fillBlank"></span>\n                        </div>\n                    </div>\n                </div>\n                <div class="answers textarea" v-show="form===\'textarea\'">\n                    <div class="input blank">\n                        <div class="blank" contenteditable="true" input="fillBlank"></div>\n                    </div>\n                </div>\n                <div class="answers time" v-show="form===\'time\'">\n                    <div class="input blank">\n                        <span class="blank" contenteditable="true" form="hour" v-show="need.time.indexOf(\'hour\') >= 0" @input="fillBlank"></span>\n                        <span class="hour" v-show="need.time.indexOf(\'hour\') >= 0">时</span>\n                        <span class="blank" contenteditable="true" form="minute" v-show="need.time.indexOf(\'minute\') >= 0" @input="fillBlank"></span>\n                        <span class="hour" v-show="need.time.indexOf(\'minute\') >= 0">分</span>\n                        <span class="blank" contenteditable="true" form="second" v-show="need.time.indexOf(\'second\') >= 0" @input="fillBlank"></span>\n                        <span class="hour" v-show="need.time.indexOf(\'second\') >= 0">秒</span>\n                    </div>\n                </div>\n                <div class="answers date" v-show="form===\'date\'">\n                    <div class="input blank">\n                        <span class="blank" contenteditable="true" form="year" v-show="need.date.indexOf(\'year\') >= 0" @input="fillBlank"></span>\n                        <span class="hour" v-show="need.date.indexOf(\'year\') >= 0">年</span>\n                        <span class="blank" contenteditable="true" form="month" v-show="need.date.indexOf(\'month\') >= 0" @input="fillBlank"></span>\n                        <span class="hour" v-show="need.date.indexOf(\'month\') >= 0">月</span>\n                        <span class="blank" contenteditable="true" form="date" v-show="need.date.indexOf(\'date\') >= 0" @input="fillBlank"></span>\n                        <span class="hour" v-show="need.date.indexOf(\'date\') >= 0">日</span>\n                    </div>\n                </div>\n            </div>\n            <div class="inner matrix" v-if="type===\'matrix\'">\n                <div class="question_head">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title">{{ title }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="description">{{ description }}</div>\n                <div class="answers matrix" v-if="form===\'row\'">\n                    <table>\n                        <thead>\n                        <tr>\n                            <th></th>\n                            <th v-for="option in options" :key="option.optionId">{{ option.value }}</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr v-for="question in sub_questions" :key="question.index">\n                            <td>{{ question.title }}</td>\n                            <td v-for="option in options" :key="option.optionId">\n                                <input :index="question.index" :name="question.title" :value="option.value" type="checkbox" v-if="the_class===\'multi\'" @change="checkMatrix">\n                                <input :index="question.index" :name="question.title" :value="option.value" type="radio" v-if="the_class===\'single\' || the_class===\'score\'" @change="checkMatrix">\n                                <input :index="question.index" :name="question.title" :sbt="option.value" type="text" v-if="the_class===\'blank\'" @change="inputMatrix">\n                            </td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div class="answers matrix" v-if="form===\'col\'">\n                    <table>\n                        <thead>\n                        <tr>\n                            <th></th>\n                            <th v-for="question in sub_questions" :key="question.index">{{ question.title }}</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr class="prefix" @mousedown="dragPrefix">\n                        <td></td>\n                        <td v-for="question in sub_questions" :key="question.index" :question_id="question.index" @input="editPrefix" class="edit-prefix"></td>\n                        </tr>\n                        <tr v-for="option in options" :key="option.optionId">\n                            <td>{{ option.value }}</td>\n                            <td v-for="question in sub_questions" :key="question.index">\n                                <input :index="question.index" :name="question.title" :value="option.value" type="checkbox" v-if="the_class===\'multi\'" @change="checkMatrix">\n                                <input :index="question.index" :name="question.title" :value="option.value" type="radio" v-if="the_class===\'single\' || the_class===\'score\'" @change="checkMatrix">\n                                <input :index="question.index" :name="question.title" :sbt="option.value" type="text" v-if="the_class===\'blank\'" @change="inputMatrix">\n                            </td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n            <div class="inner score" v-if="type===\'score\'">\n                <div class="question_head">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title">{{ title }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="description">{{ description }}</div>\n                <div class="answers score">\n                    <div class="score" v-for="option in options" :key="option.optionId">\n                        <input :option_code="option.optionId" :id="\'score_q\' + index + \'_op\' + option.optionId" :name="\'q\' + index" type="radio" :value="option.value" @change="mark">\n                        <label :for="\'score_q\' + index + \'_op\' + option.optionId">\n                            <span v-show="form===\'text\'">{{ option.value }}</span>\n                            <span v-show="form===\'number\'">{{ option.score }}</span>\n                        </label>\n                    </div>\n                </div>\n            </div>\n            <div class="inner sort" v-if="type===\'sort\'">\n                <div class="question_head">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title">{{ title }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="description">{{ description }}</div>\n                <div class="answers sort">\n                    <div class="to-sort">\n                        <div class="sort" v-for="option in options" :value="option.value" :key="option.optionId">\n                            <input :id="\'checks_q\' + index + \'_op\' + option.optionId" :name="\'q\' + index" type="checkbox" :value="option.value" @change="sort">\n                            <label :for="\'checks_q\' + index + \'_op\' + option.optionId">\n                                <span>{{ option.value }}</span>\n                            </label>\n                        </div>\n                    </div>\n                    <div class="sorted">\n                        <div class="sort" v-for="sort in sorted" :value="sort" @click="unsort">\n                            {{ sorted.indexOf(sort) + \'. \' + sort }}\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n\n            <div class="inners" :id="\'q\' + index" v-if="type instanceof Array">\n            <div class="inner message name">\n\n                <div class="question_head name" v-if="type.indexOf(\'name\') > -1" >\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="name">{{ title.name }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers name" v-if="type.indexOf(\'name\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head sex" v-if="type.indexOf(\'sex\') > -1" >\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="sex">{{ title.sex }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers sex" v-if="type.indexOf(\'sex\') > -1">\n                    <div class="input choice">\n                        <input option_code="1" :id="\'radio_q\' + index + \'_op1\'" :name="\'q\' + index + \'sex\'" type="radio" value="男" @change="check">\n                        <label :for="\'radio_q\' + index + \'_op1\'">\n                            <i class="icon"><span></span></i>\n                            <span class="option_text">男</span>\n                        </label>\n                    </div>\n                    <div class="input choice">\n                        <input option_code="2" :id="\'radio_q\' + index + \'_op2\'" :name="\'q\' + index + \'sex\'" type="radio" value="女" @change="check">\n                        <label :for="\'radio_q\' + index + \'_op2\'">\n                            <i class="icon"><span></span></i>\n                            <span class="option_text">女</span>\n                        </label>\n                    </div>\n                </div>\n\n                <div class="question_head age" v-if="type.indexOf(\'age\') > -1" >\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="age">{{ title.age }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers age" v-if="type.indexOf(\'age\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head telephone" v-if="type.indexOf(\'telephone\') > -1" >\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="telephone">{{ title.telephone }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers telephone" v-if="type.indexOf(\'telephone\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head email" v-if="type.indexOf(\'email\') > -1" >\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="email">{{ title.email }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers email" v-if="type.indexOf(\'email\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head company" v-if="type.indexOf(\'company\') > -1" >\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="company">{{ title.company }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers company" v-if="type.indexOf(\'company\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head job" v-if="type.indexOf(\'job\') > -1" >\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="job">{{ title.job }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers job" v-if="type.indexOf(\'job\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head industry" v-if="type.indexOf(\'industry\') > -1" >\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="industry">{{ title.industry }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers industry" v-if="type.indexOf(\'industry\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head address" v-if="type.indexOf(\'address\') > -1">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="address">{{ title.address }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers address" v-if="type.indexOf(\'address\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head highschool" v-if="type.indexOf(\'highschool\') > -1">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="highschool">{{ title.highschool }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers highschool" v-if="type.indexOf(\'highschool\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n\n                <div class="question_head education" v-if="type.indexOf(\'education\') > -1">\n                    <span class="question_index">\n                        <span class="index">{{ ordericon || index }}</span>.\n                    </span>\n                    <span class="question_title" name="highschool">{{ title.highschool }}</span>\n                    <span class="question_require" v-show="required">*</span>\n                </div>\n                <div class="answers education" v-if="type.indexOf(\'education\') > -1">\n                    <div class="input">\n                        <span class="blank" contenteditable="true" @input="fillBlank"></span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        </div>\n        ',funcs:{check:function(n){var e=$(n.target),s=e.siblings("label").find(".icon"),i=this.type;o.answers[this.index]||(o.answers[this.index]={itemId:this.idInSQL,type:"",codes:[],values:[]}),"choice"===i?(o.answers[this.index].type="choice",!0===e.prop("checked")?(o.answers[this.index].values[0]=e.val(),o.answers[this.index].codes[0]=e.attr("option_code"),e.parents(".answers").find(".icon").removeClass("picked"),s.addClass("picked")):(o.answers[this.index].values=[],o.answers[this.index].codes=[],s.removeClass("picked"))):"checks"===i&&(o.answers[this.index].type="checks",!0===e.prop("checked")?(o.answers[this.index].values.push(e.val()),o.answers[this.index].codes.push(e.attr("option_code")),s.addClass("picked")):(o.answers[this.index].values.splice(o.answers[this.index].values.indexOf(e.val()),1),o.answers[this.index].codes.splice(o.answers[this.index].codes.indexOf(e.attr("option_code")),1),s.removeClass("picked")))},fillCheck:function(n){var e=$(n.target),s=e.siblings("input"),i=s.attr("id").match(/_op(\d+)/)[1];this.options[i];/\+/.test(s.val())||s.val(s.val()+"+"),s.val(s.val().replace(/\+[\s\S]*/g,"+ "+e.text()))},fillBlank:function(n){var e=$(n.target),s=this.form;o.answers[this.index]||(o.answers[this.index]={itemId:this.idInSQL,type:"blank",form:s,values:[]}),"single"===s||"textarea"===s?o.answers[this.index].values[0]=e.text():"multi"===s?o.answers[this.index].values[e.attr("index")]={code:e.attr("question_code"),value:e.text()}:"time"!==s&&"date"!==s||(o.answers[this.index].values[0]={},o.answers[this.index].values[0][e.attr("form")]=e.text())},checkMatrix:function(n){var e=$(n.target),s=this.theClass,i=e.attr("name"),t=e.attr("value");o.answers[this.index]||(o.answers[this.index]={itemId:this.idInSQL,type:"matrix",form:s,values:[]});var a=o.answers[this.index].values;if("single"===s||"score"===s){if(!0===e.prop("checked")){for(var d=0,l=a.length;d<l;d++)a[d].subtitle===i&&a.splice(d,1);o.answers[this.index].values[0]={subtitle:i,option:t,coordinate:e.attr("index")+"-"+e.attr("value")}}}else if("multi"===s)if(!0===e.prop("checked"))a.push({subtitle:i,option:t,coordinate:e.attr("index")+"-"+e.attr("value")});else for(var r=0,p=a.length;r<p;r++)a[r].subtitle===i&&a.option===t&&a.splice(r,1)},inputMatrix:function(n){var e=$(n.target);o.answers[this.index]||(o.answers[this.index]={itemId:this.idInSQL,type:"matrix",form:"blank",values:[]});for(var s=o.answers[this.index].values,i=0,t=s.length;i<t;i++)if(s[i].subtitle===subtitle&&s[i].option===option)return void(s[i].value=e.val());s.push({subtitle:subtitle,option:option,coordinate:e.attr("index")+"-"+e.attr("value"),value:e.val()})},mark:function(n){var e=$(n.target);o.answers[this.index]||(o.answers[this.index]={itemId:this.idInSQL,type:"score",codes:[],values:[]}),!0===e.prop("checked")?(o.answers[this.index].values=[$(n.target).val()],o.answers[this.index].codes=[$(n.target).attr("option_code")],e.parents(".answers").find("label").removeClass("marked"),e.siblings("label").addClass("marked")):(o.answers[this.index].values=[],o.answers[this.index].codes=[])},sort:function(n){var e=$(n.target);o.answers[this.index]||(o.answers[this.index]={itemId:this.idInSQL,type:"sort",values:[]});var s=o.answers[this.index].values,i=e.siblings("label").find("i"),t=e.val();e.prop("checked")?(e.hide(),s.push(t)):(s.splice(s.indexOf(t),1),i.text(""),e.parents(".answers").find("input").each(function(){var n=$(this),e=s.indexOf(n.val());e>-1&&n.siblings("label").find("i").text(e+1)}))},unsort:function(n){var e=$(n.target),s=JSON.parse(JSON.stringify(o.answers[this.index].values)),i=e.attr("value");s.splice(s.indexOf(i),1),o.answers[this.index].values=s,e.parents("answers.sort").find("to-sort").find(".sort[value="+i+"]").show().find("input").prop("checked",!0)}}};Vue.component("qs",{props:["index","ordericon","item_id","title","type","form","the_class","active","description","required","options","sub_questions","need","jump","depend","quote","relate","evaluate","sorted"],template:o.tpl,methods:{check:function(n){this.$emit("check",n)},fillCheck:function(n){this.$emit("fill_check",n)},fillBlank:function(n){this.$emit("fill_blank",n)},checkMatrix:function(n){this.$emit("check_matrix",n)},inputMatrix:function(n){this.$emit("input_matrix",n)},mark:function(n){this.$emit("mark",n)},sort:function(n){this.$emit("sort",n)},unsort:function(n){this.$emit("unsort",n)}}}),$("#previous").on("click",o.previousQ.bind(o)),$("#next").on("click",o.nextQ.bind(o)),$("#start").on("click",o.startQuestionnaire.bind(o)),$("#save").on("click",o.submitAnswers.bind(o)),$.ajax({url:l+"/questionnaire/Default",type:"post",contentType:"application/json;charset=utf-8",dataType:"json",async:!0,data:JSON.stringify(e),success:function(n){return"1"===n[0].result[0].state?(alert("该问卷尚未编辑完成"),!1):"3"===n[0].result[0].state?(alert("该问卷已停止收集"),!1):("4"===n[0].result[0].state&&(o.submitAnswers=function(n){}),"1"===n[0].linTag?(alert("此链接已经失效"),document.location.href=l+"/html/kolpanel/endSurvey.html",!1):"3"===n[0].linTag?(alert("此链接被提交完成"),document.location.href=l+"/html/kolpanel/completeSurvey.html",!1):void o.displaySurvey(n[0].result[0]))},error:function(n){}})}())}]);